
# coding: utf-8

# # Fourier analysis of the endocing pulses produced by the [Yale group](https://www.nature.com/articles/nature18949) 

# In[1]:


import matplotlib.pyplot as plt
import numpy as np

def normalisePoints(x,y,x_max):
    x = x - x[9]
    x = x * (x_max/x[-1])
    y = y - y[0]
    y = y/np.max(y)
    return (x,y)

def plotPulsesTimeDomain(pulses, title):
    fig1, ax = plt.subplots(1,1, figsize=(15,5))
    ax.plot(pulses[0],pulses[1],'r')
    ax.plot(pulses[2],pulses[3],'b')
    ax.set_xlabel('Time (ns)')
    ax.set_ylabel('Amp')
    ax.set_title(title)
    return fig1, ax

def plotPulsesPhaseSpace(pulses, title):
    fig1, ax = plt.subplots(1,1, figsize=(5,5))
    ax.plot(pulses[1],pulses[3],'k')
    ax.set_xlabel('I')
    ax.set_ylabel('Q')
    ax.set_title(title)
    return fig1, ax

# Resonator pulse
I_x = np.array([33.9192963,34.1278992,34.3365021,34.5451965,34.7537994,34.9624023,35.1710052,35.3796997,35.5883026,35.7969,36.0054932,36.2142,36.4228,36.84,37.0487,37.2573,37.4659,37.6745,37.8832,38.0918,38.3004,38.509,38.7177,38.9263,39.1349,39.3436,39.7608,39.9694,40.1781,40.3867,40.5953,40.8039,41.0126,41.2212,41.4298,41.6384,41.8471,42.0557,42.2643,42.4729,42.8902,43.0988,43.3074,43.5161,43.7247,43.9333,44.142,44.3506,44.5592,44.7678,44.9765,45.1851,45.3937,45.811,46.0196,46.2282,46.4368,46.6455,46.8541,47.0627,47.2713,47.48,47.6886,47.8972,48.1059,48.3145,48.7317,48.9404,49.149,49.3576,49.5662,49.7749,49.9835,50.1921,50.4007,50.6094,50.818,51.0266,51.2352,51.4439,51.8611,52.0697,52.2784,52.487,52.6956,52.9042,53.1129,53.3215,53.5301,53.7388,53.9474,54.156,54.3646,54.7819,54.9905,55.1991,55.4078,55.6164,55.825,56.0336,56.2423,56.4509,56.6595,56.8681,57.0768,57.2854,57.7026,57.9113,58.1199,58.3285,58.5371,58.7458,58.9544,59.163,59.3716,59.5803,59.7889,59.9975,60.2061,60.4148,60.832,61.0406,61.2493,61.4579,61.6665,61.8752,62.0838,62.2924,62.501,62.7097,62.9183,63.1269,63.3355,63.7528,63.9614,64.17,64.3787,64.5873,64.7959,65.0045,65.2132,65.4218,65.6304,65.8391,66.0477,66.2563,66.4649,66.8822,67.0908,67.2994,67.5081,67.7167,67.9253,68.1339,68.3426,68.5512,68.7598,68.9684,69.1771,69.3857,69.8029,70.0116,70.2202,70.4288,70.6375,70.8461,71.0547,71.2633,71.472,71.6806,71.8892,72.0978,72.3065,72.7237,72.9323,73.141,73.3496,73.5582,73.7668,73.9755,74.1841,74.3927,74.6013,74.81,75.0186,75.2272,75.4359,75.8531,76.0617,76.2704,76.479,76.6876,76.8962,77.1049,77.3135,77.5221,77.7307,77.9394,78.148,78.3566,78.7739,78.9825,79.1911,79.3997,79.6084,79.817,80.0256,80.2343,80.4429,80.6515,80.8601,81.0688,81.2774,81.6946,81.9033,82.1119,82.3205,82.5291,82.7378,82.9464,83.155,83.3636,83.5723,83.7809,83.9895,84.1982,84.4068,84.824,85.0327,85.2413,85.4499,85.6585,85.8672,86.0758,86.2844,86.493,86.7017,86.9103,87.1189,87.3275,87.7448,87.9534,88.162,88.3707,88.5793,88.7879,88.9965,89.2052,89.4138,89.6224,89.8311,90.0397,90.2483,90.6656,90.8742,91.0828,91.2914,91.5001,91.7087,91.9173,92.1259,92.3346,92.5432,92.7518,92.9604,93.1691,93.3777,93.7949,94.0036,94.2122,94.4208,94.6294,94.8381,95.0467,95.2553,95.4639,95.6726,95.8812,96.0898,96.2984,96.7157,96.9243,97.1329,97.3416,97.5502,97.7588,97.9675,98.1761,98.3847,98.5933,98.802,99.0106,99.2192,99.4278,99.8451,100.0537,100.2623,100.471,100.6796,100.8882,101.0968,101.3055,101.5141,101.7227,101.9314,102.14,102.3489,102.7661,102.9748,103.1834,103.392,103.6006,103.8093,104.0179,104.2265,104.4352,104.6438,104.8524,105.061,105.2697,105.6869,105.8955,106.1042,106.3128,106.5214,106.73,106.9387,107.1473,107.3559,107.5645,107.7732,107.9818,108.1904,108.399,108.8163,109.0249,109.2336,109.4422,109.6508,109.8594,110.0681,110.2767,110.4853,110.6939,110.9026,111.1112,111.3198,111.7371,111.9457,112.1543,112.3629,112.5716,112.7802,112.9888,113.1974,113.4061,113.6147,113.8233,114.0319,114.2406,114.6578,114.8664,115.0751,115.2837,115.4923,115.7009,115.9096,116.1182,116.3268,116.5354,116.7441,116.9527,117.1613,117.3699,117.7872,117.9958,118.2045,118.4131,118.6217,118.8303,119.039,119.2476,119.4562,119.6648,119.8735,120.0821,120.2907,120.708,120.9166,121.1252,121.3338,121.5425,121.7511,121.9597,122.1684,122.377,122.5856,122.7942,123.0029,123.2115,123.4201,123.8374,124.046,124.2546,124.4632,124.6719,124.8805,125.0891,125.2977,125.5064,125.715,125.9236,126.1322,126.3409,126.7581,126.9668,127.1754,127.384,127.5926,127.8013,128.0099,128.2185,128.4271,128.6357,128.8444,129.053,129.2616,129.6789,129.8875,130.0961,130.3047,130.5134,130.722,130.9306,131.1393,131.3479,131.5565,131.7651,131.9738,132.1824,132.391,132.8083,133.0169,133.2255,133.4341,133.6428,133.8514,134.06,134.2686,134.4773,134.6859,134.8945,135.1032,135.3118,135.729,135.9377,136.1463,136.3549,136.5635,136.7722,136.9808,137.1894,137.398,137.6067,137.8153,138.0239,138.2325,138.6498,138.8584,139.067,139.2757,139.4843,139.6929,139.9016,140.1102,140.3188,140.5274,140.7361,140.9447,141.1533,141.3619,141.7792,141.9878,142.1964,142.4051,142.6137,142.8223,143.0309,143.2396,143.4482,143.6568,143.8654,144.0741,144.2827,144.7,144.9086,145.1172,145.3258,145.5345,145.7431,145.9517,146.1603,146.369,146.5776,146.7862,146.9948,147.2035])
I_y = np.array([351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,352.6564941,354.7427,357.6634979,361.0015,364.1309,367.2603,369.7638,372.0587,373.9363,375.3967,376.2312,376.8571,377.0657,376.8571,376.4398,376.0226,375.1881,374.3536,373.5191,372.6846,371.8501,370.8069,369.9724,369.1379,368.5121,367.6776,367.0517,366.2172,365.5913,364.9654,364.3395,363.7137,363.0878,362.2533,361.6274,361.0015,360.167,359.5411,358.7066,358.0807,357.2462,356.4117,355.5772,354.5341,353.6996,352.8651,352.0306,351.4047,350.5702,349.9441,349.1096,348.4837,347.8578,347.0233,346.3974,345.7715,345.3543,344.937,344.5198,344.1025,343.6853,343.6853,343.4767,343.4767,343.6853,343.8939,344.1025,344.5198,345.1457,345.7715,346.3974,347.0233,347.6492,348.2751,349.1096,349.7354,350.3616,351.1961,351.822,352.2392,352.8651,353.491,353.9082,354.5341,354.9514,355.5772,355.9945,356.4117,356.829,357.0376,357.2462,357.2462,357.2462,357.2462,357.2462,357.0376,356.829,356.4117,355.7859,354.9514,354.3255,353.491,352.4478,351.6133,350.5702,349.5268,348.4837,347.4406,346.606,345.7715,344.937,344.1025,343.268,342.8508,342.4335,342.2249,341.8076,341.599,341.1818,340.9731,341.1818,341.599,342.2249,343.0594,344.1025,345.1457,345.9802,347.0233,347.8578,348.6923,349.3182,349.7354,350.1527,350.3616,350.3616,350.1527,349.9441,349.7354,349.5268,349.1096,348.6923,348.4837,348.2751,348.2751,348.2751,348.2751,348.4837,348.9009,349.3182,349.9441,350.5702,351.1961,352.0306,352.8651,353.6996,354.5341,355.3686,355.9945,356.6204,357.0376,357.4549,357.6635,358.0807,358.2894,358.498,358.9153,358.9153,358.9153,358.9153,358.7066,358.498,358.2894,357.8721,357.4549,357.0376,356.6204,356.2031,355.7859,355.5772,355.16,354.9514,354.9514,354.7427,354.9514,354.9514,355.16,355.3686,355.5772,355.9945,356.2031,356.4117,356.4117,356.4117,356.4117,356.4117,355.9945,355.7859,355.3686,354.9514,354.3255,353.9082,353.491,353.0737,352.6565,352.2392,352.0306,351.822,351.6133,351.6133,351.6133,351.6133,351.6133,351.6133,351.6133,351.6133,351.4047,351.4047,351.1961,350.7788,350.5702,350.3616,350.1527,350.1527,349.9441,349.9441,349.9441,350.1527,350.3616,350.3616,350.5702,350.7788,350.9875,350.9875,350.9875,350.7788,350.5702,350.3616,349.9441,349.5268,349.1096,348.9009,348.4837,348.2751,348.0664,347.8578,347.8578,348.0664,348.2751,348.4837,348.9009,349.3182,349.5268,349.9441,350.3616,350.5702,350.7788,350.9875,350.9875,350.9875,350.9875,350.7788,350.5702,350.3616,349.9441,349.7354,349.5268,349.1096,348.9009,348.6923,348.4837,348.2751,348.2751,348.2751,348.2751,348.4837,348.6923,348.9009,349.3182,349.5268,349.9441,350.1527,350.5702,350.7788,350.9875,351.1961,351.4047,351.4047,351.4047,351.4047,351.4047,351.4047,351.4047,351.1961,351.1961,350.9875,350.7788,350.5702,350.3616,349.9441,349.7354,349.3182,349.1096,348.6923,348.4837,348.2751,348.0664,347.8578,347.6492,347.6492,347.6492,347.6492,347.8578,348.0664,348.2751,348.4837,348.9009,349.1096,349.5268,349.7354,349.9441,349.9441,349.9441,349.7354,349.3182,348.9009,348.2751,347.6492,346.8147,345.9802,345.3543,344.5198,343.6853,343.0594,342.4335,341.8076,341.599,341.1818,341.1818,340.9731,341.1818,341.1818,341.3904,341.8076,342.2249,342.6422,343.0594,343.6853,344.1025,344.7284,345.3543,345.9802,346.3974,346.606,347.0233,347.0233,347.2319,347.4406,347.4406,347.8578,348.0664,348.6923,349.5268,350.5702,352.0306,353.491,355.3686,357.2462,359.5411,361.6274,363.9223,366.2172,368.3034,370.3897,372.0587,373.5191,374.145,374.5622,374.7708,375.3967,376.2312,376.4398,375.814,375.6053,376.6485,378.5261,380.1951,381.6555,382.49,383.1159,383.5331,383.3245,383.3245,382.6986,381.8641,381.0296,380.1951,379.3606,378.3175,376.6485,374.145,370.8069,366.843,361.6274,356.829,354.3255,353.6996,353.9082,353.9082,353.6996,353.2823,353.0737,353.0737,353.491,353.6996,353.9082,353.6996,353.0737,351.6133,349.7354,347.8578,346.1888,344.5198,342.8508,340.7645,339.0955,338.4696,338.4696,338.6783,339.0955,339.5128,339.93,340.5559,340.9731,341.1818,341.1818,341.3904,341.8076,341.8076,340.7645,339.3041,338.261,338.6783,339.93,341.1818,342.8508,345.7715,349.7354,354.3255,358.7066,362.4619,364.7568,364.9654,362.8792,358.9153,353.6996,348.0664,342.6422,338.0524,334.5057,332.0022,330.3332,329.4987,328.8728,328.2469,327.6211,327.6211,327.8297,328.4556,329.2901,330.5418,332.0022,333.6712,335.5489,337.6351,339.7214,342.0163,344.5198,347.4406,350.3616,353.0737,355.9945,358.498,360.7929,362.8792,364.5482,365.7999,366.6344,367.0517,366.843,366.0085,364.7568,363.2964,361.4188,359.3325,357.2462,355.16,353.491,352.2392,351.6133])
Q_x = np.array([33.9192963,34.1278992,34.3365021,34.5451965,34.7537994,34.9624023,35.1710052,35.3796997,35.5883026,35.7969055,36.0054932,36.2142029,36.4228058,36.8399963,37.0487061,37.2572937,37.4658966,37.6744995,37.883194,38.0917969,38.3003998,38.5090027,38.7176971,38.9263,39.134903,39.3435974,39.7608032,39.9694061,40.1781006,40.3867035,40.5953064,40.803894,41.0126038,41.2212067,41.4297943,41.6383972,41.8471069,42.0557,42.2643,42.4729,42.8902,43.0988,43.3074,43.5161,43.7247,43.9333,44.142,44.3506,44.5592,44.7678,44.9765,45.1851,45.3937,45.811,46.0196,46.2282,46.4368,46.6455,46.8541,47.0627,47.2713,47.48,47.6886,47.8972,48.1059,48.3145,48.7317,48.9404,49.149,49.3576,49.5662,49.7749,49.9835,50.1921,50.4007,50.6094,50.818,51.0266,51.2352,51.4439,51.8611,52.0697,52.2784,52.487,52.6956,52.9042,53.1129,53.3215,53.5301,53.7388,53.9474,54.156,54.3646,54.7819,54.9905,55.1991,55.4078,55.6164,55.825,56.0336,56.2423,56.4509,56.6595,56.8681,57.0768,57.2854,57.7026,57.9113,58.1199,58.3285,58.5371,58.7458,58.9544,59.163,59.3716,59.5803,59.7889,59.9975,60.2061,60.4148,60.832,61.0406,61.2493,61.4579,61.6665,61.8752,62.0838,62.2924,62.501,62.7097,62.9183,63.1269,63.3355,63.7528,63.9614,64.17,64.3787,64.5873,64.7959,65.0045,65.2132,65.4218,65.6304,65.8391,66.0477,66.2563,66.4649,66.8822,67.0908,67.2994,67.5081,67.7167,67.9253,68.1339,68.3426,68.5512,68.7598,68.9684,69.1771,69.3857,69.8029,70.0116,70.2202,70.4288,70.6375,70.8461,71.0547,71.2633,71.472,71.6806,71.8892,72.0978,72.3065,72.7237,72.9323,73.141,73.3496,73.5582,73.7668,73.9755,74.1841,74.3927,74.6013,74.81,75.0186,75.2272,75.4359,75.8531,76.0617,76.2704,76.479,76.6876,76.8962,77.1049,77.3135,77.5221,77.7307,77.9394,78.148,78.3566,78.7739,78.9825,79.1911,79.3997,79.6084,79.817,80.0256,80.2343,80.4429,80.6515,80.8601,81.0688,81.2774,81.6946,81.9033,82.1119,82.3205,82.5291,82.7378,82.9464,83.155,83.3636,83.5723,83.7809,83.9895,84.1982,84.4068,84.824,85.0327,85.2413,85.4499,85.6585,85.8672,86.0758,86.2844,86.493,86.7017,86.9103,87.1189,87.3275,87.7448,87.9534,88.162,88.3707,88.5793,88.7879,88.9965,89.2052,89.4138,89.6224,89.8311,90.0397,90.2483,90.6656,90.8742,91.0828,91.2914,91.5001,91.7087,91.9173,92.1259,92.3346,92.5432,92.7518,92.9604,93.1691,93.3777,93.7949,94.0036,94.2122,94.4208,94.6294,94.8381,95.0467,95.2553,95.4639,95.6726,95.8812,96.0898,96.2984,96.7157,96.9243,97.1329,97.3416,97.5502,97.7588,97.9675,98.1761,98.3847,98.5933,98.802,99.0106,99.2192,99.4278,99.8451,100.0537,100.2623,100.471,100.6796,100.8882,101.0968,101.3055,101.5141,101.7227,101.9314,102.14,102.3489,102.7661,102.9748,103.1834,103.392,103.6006,103.8093,104.0179,104.2265,104.4352,104.6438,104.8524,105.061,105.2697,105.6869,105.8955,106.1042,106.3128,106.5214,106.73,106.9387,107.1473,107.3559,107.5645,107.7732,107.9818,108.1904,108.399,108.8163,109.0249,109.2336,109.4422,109.6508,109.8594,110.0681,110.2767,110.4853,110.6939,110.9026,111.1112,111.3198,111.7371,111.9457,112.1543,112.3629,112.5716,112.7802,112.9888,113.1974,113.4061,113.6147,113.8233,114.0319,114.2406,114.6578,114.8664,115.0751,115.2837,115.4923,115.7009,115.9096,116.1182,116.3268,116.5354,116.7441,116.9527,117.1613,117.3699,117.7872,117.9958,118.2045,118.4131,118.6217,118.8303,119.039,119.2476,119.4562,119.6648,119.8735,120.0821,120.2907,120.708,120.9166,121.1252,121.3338,121.5425,121.7511,121.9597,122.1684,122.377,122.5856,122.7942,123.0029,123.2115,123.4201,123.8374,124.046,124.2546,124.4632,124.6719,124.8805,125.0891,125.2977,125.5064,125.715,125.9236,126.1322,126.3409,126.7581,126.9668,127.1754,127.384,127.5926,127.8013,128.0099,128.2185,128.4271,128.6357,128.8444,129.053,129.2616,129.6789,129.8875,130.0961,130.3047,130.5134,130.722,130.9306,131.1393,131.3479,131.5565,131.7651,131.9738,132.1824,132.391,132.8083,133.0169,133.2255,133.4341,133.6428,133.8514,134.06,134.2686,134.4773,134.6859,134.8945,135.1032,135.3118,135.729,135.9377,136.1463,136.3549,136.5635,136.7722,136.9808,137.1894,137.398,137.6067,137.8153,138.0239,138.2325,138.6498,138.8584,139.067,139.2757,139.4843,139.6929,139.9016,140.1102,140.3188,140.5274,140.7361,140.9447,141.1533,141.3619,141.7792,141.9878,142.1964,142.4051,142.6137,142.8223,143.0309,143.2396,143.4482,143.6568,143.8654,144.0741,144.2827,144.7,144.9086,145.1172,145.3258,145.5345,145.7431,145.9517,146.1603,146.369,146.5776,146.7862,146.9948,147.2035])
Q_y = np.array([351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.6132965,351.196106,349.7353973,347.6492004,345.5628967,343.4766998,341.598999,339.721405,338.2610016,336.8005981,335.5489044,334.7144012,333.8798981,333.4626007,333.0453033,333.0453033,333.2539978,333.8798981,334.5057068,335.7575073,337.009201,338.678299,340.5558929,342.4335022,344.5198059,346.6060028,348.6923065,350.7787933,352.6564941,354.3255005,355.7859,357.0376,358.0807,358.9153,359.3325,359.7498,359.7498,359.7498,359.3325,358.9153,358.498,357.8721,357.0376,356.2031,355.3686,354.3255,353.2823,352.0306,350.7788,349.5268,348.0664,346.606,345.1457,343.4767,342.0163,340.5559,339.3041,337.8438,336.592,335.5489,334.7144,334.0885,333.4626,333.0453,332.8367,332.8367,332.8367,333.254,333.6712,334.0885,334.7144,335.3402,336.3834,337.2179,338.4696,339.7214,340.9731,342.4335,344.1025,345.9802,347.6492,349.7354,351.6133,353.6996,355.5772,357.6635,359.7498,361.6274,363.505,365.3827,367.2603,368.7207,370.1811,371.6414,372.6846,373.5191,374.145,374.5622,374.7708,374.7708,374.5622,374.145,373.5191,373.1018,372.2673,371.6414,371.0156,370.3897,369.5552,369.1379,368.5121,367.8862,367.2603,366.843,366.2172,365.7999,365.174,364.5482,363.7137,362.6705,361.6274,360.5843,359.5411,358.498,357.4549,356.4117,355.3686,354.1169,353.0737,351.822,350.7788,349.5268,348.4837,347.6492,346.8147,345.9802,345.3543,344.7284,344.3112,343.8939,343.6853,343.268,343.0594,342.8508,342.6422,342.2249,342.0163,341.599,341.3904,340.9731,340.5559,340.1386,339.7214,339.0955,338.6783,338.261,337.6351,337.2179,336.8006,336.1747,335.7575,335.3402,335.1316,335.1316,335.3402,335.7575,336.3834,337.2179,338.4696,339.7214,341.1818,342.6422,344.3112,345.9802,347.4406,349.1096,350.5702,351.822,352.8651,353.6996,354.5341,354.9514,355.3686,355.5772,355.5772,355.3686,355.3686,354.9514,354.7427,354.5341,354.3255,354.1169,353.9082,353.9082,353.9082,354.1169,354.3255,354.7427,355.16,355.7859,356.2031,356.829,357.4549,357.8721,358.2894,358.7066,358.9153,359.1239,359.1239,358.9153,358.7066,358.498,358.0807,357.6635,357.2462,356.829,356.4117,355.9945,355.5772,355.3686,355.16,354.9514,354.7427,354.5341,354.5341,354.5341,354.5341,354.3255,354.3255,354.1169,354.1169,353.9082,353.491,353.2823,352.8651,352.4478,351.822,351.4047,350.7788,350.3616,349.9441,349.3182,349.1096,348.6923,348.4837,348.2751,348.2751,348.2751,348.2751,348.4837,348.6923,348.9009,349.3182,349.5268,349.7354,349.9441,349.9441,349.9441,349.9441,349.7354,349.5268,349.3182,348.9009,348.4837,348.2751,347.8578,347.4406,347.0233,346.8147,346.606,346.606,346.3974,346.3974,346.606,346.606,346.8147,346.8147,347.0233,347.0233,347.0233,347.0233,347.0233,346.8147,346.606,346.1888,345.9802,345.5629,345.3543,345.1457,344.937,344.937,345.1457,345.3543,345.7715,346.3974,347.0233,347.6492,348.4837,349.3182,349.9441,350.3616,350.7788,350.9875,350.9875,350.7788,350.3616,349.5268,348.4837,347.4406,346.1888,344.937,343.6853,342.6422,341.599,340.9731,340.5559,340.3473,340.5559,341.1818,342.0163,343.0594,344.3112,345.5629,347.0233,348.4837,349.9441,351.1961,352.2392,353.0737,353.9082,354.3255,354.7427,354.9514,354.9514,354.9514,354.7427,354.5341,354.5341,354.3255,354.1169,353.9082,353.9082,353.6996,353.9082,354.1169,354.5341,354.9514,355.5772,356.2031,356.829,357.2462,357.4549,357.6635,357.6635,357.6635,357.6635,357.4549,357.4549,357.4549,357.6635,357.8721,358.498,358.9153,359.5411,360.3756,361.0015,361.6274,362.2533,362.6705,363.0878,363.505,363.9223,364.5482,365.174,366.6344,368.5121,371.2242,374.145,376.8571,378.7347,379.7778,380.821,381.8641,381.6555,379.3606,374.145,367.0517,360.167,356.6204,357.0376,358.498,357.0376,353.9082,352.6565,354.1169,355.16,352.6565,348.9009,348.2751,350.5702,353.6996,356.4117,359.1239,361.2101,361.4188,359.9584,357.4549,354.7427,352.6565,351.4047,351.4047,352.0306,353.0737,354.3255,354.9514,354.9514,354.3255,352.8651,350.7788,348.0664,345.1457,342.4335,340.7645,340.5559,342.2249,344.937,347.2319,348.6923,349.3182,349.7354,350.7788,352.4478,354.5341,355.9945,356.4117,355.16,352.4478,349.9441,348.6923,350.1527,354.7427,361.6274,368.5121,372.0587,371.0156,366.843,361.6274,357.6635,354.9514,353.491,352.6565,352.0306,350.7788,348.6923,346.3974,344.3112,343.268,343.4767,344.7284,346.3974,347.8578,348.0664,347.0233,345.5629,344.937,344.1025,342.8508,340.9731,339.0955,337.4265,335.5489,333.8799,332.2108,331.1677,330.5418,330.3332,330.3332,330.5418,331.1677,332.0022,333.0453,334.2971,335.7575,337.2179,338.8869,340.3473,342.0163,343.4767,344.7284,345.9802,347.2319,348.2751,349.1096,349.7354,350.3616,350.7788,351.1961,351.4047,351.6133,351.6133])
(I_x, I_y) = normalisePoints(I_x,I_y,len(I_x))
(Q_x, Q_y) = normalisePoints(Q_x,Q_y,len(I_x))
resonator_pulses = (I_x, I_y, Q_x, Q_y)

# Qubit pulse
Q_x = np.array([159.3841,159.5927,159.8014,160.01,160.2186,160.4272,160.6359,160.8445,161.0531,161.2617,161.4704,161.679,161.8876,162.3049,162.5135,162.7221,162.9308,163.1394,163.348,163.5566,163.7653,163.9739,164.1825,164.3911,164.5998,164.8084,165.2256,165.4343,165.6429,165.8515,166.0602,166.2688,166.4774,166.686,166.8947,167.1033,167.3119,167.5205,167.7292,167.9378,168.355,168.5637,168.7723,168.9809,169.1895,169.3982,169.6068,169.8154,170.024,170.2327,170.4413,170.6499,170.8586,171.2758,171.4844,171.6931,171.9017,172.1103,172.3189,172.5276,172.7362,172.9448,173.1534,173.3621,173.5707,173.7793,174.1966,174.4052,174.6138,174.8224,175.0311,175.2397,175.4483,175.657,175.8656,176.0742,176.2828,176.4915,176.7001,176.9087,177.326,177.5346,177.7432,177.9518,178.1605,178.3691,178.5777,178.7863,178.995,179.2036,179.4122,179.6208,179.8295,180.2467,180.4554,180.664,180.8726,181.0812,181.2899,181.4985,181.7071,181.9157,182.1244,182.333,182.5416,182.7502,183.1675,183.3761,183.5847,183.7934,184.002,184.2106,184.4192,184.6279,184.8365,185.0451,185.2537,185.4624,185.671,185.8796,186.2969,186.5055,186.7141,186.9228,187.1314,187.34,187.5486,187.7573,187.9659,188.1745,188.3831,188.5918,188.8004,189.2176,189.4263,189.6349,189.8435,190.0521,190.2608,190.4694,190.678,190.8866,191.0953,191.3039,191.5125,191.7211,191.9298,192.347,192.5557,192.7643,192.9729,193.1815,193.3902,193.5988,193.8074,194.016,194.2247,194.4333,194.6419,194.8505,195.2678,195.4764,195.685,195.8937,196.1023,196.3109,196.5195,196.7282,196.9368,197.1454,197.354,197.5627,197.7713,198.1886,198.3972,198.6058,198.8144,199.0231,199.2317,199.4403,199.6489,199.8576,200.0662,200.2748,200.4834,200.6921,200.9007,201.3179,201.5266,201.7352,201.9438,202.1525,202.3611,202.5697,202.7783,202.987,203.1956,203.4042,203.6128,203.8215,204.2387,204.4473,204.656,204.8646,205.0732,205.2818,205.4905,205.6991,205.9077,206.1163,206.325,206.5336,206.7422,207.1595,207.3681,207.5767,207.7854,207.994,208.2026,208.4112,208.6199,208.8285,209.0371,209.2457,209.4544,209.663,209.8716,210.2889,210.4975,210.7061,210.9147,211.1234,211.332,211.5406,211.7492,211.9579,212.1665,212.3751,212.5837,212.7924,213.2096,213.4182,213.6269,213.8355,214.0441,214.2527,214.4614,214.67,214.8786,215.0872,215.2959,215.5045,215.7131,216.1304,216.339,216.5476,216.7563,216.9649,217.1735,217.3821,217.5908,217.7994,218.008,218.2166,218.4253,218.6339,218.8425,219.2598,219.4684,219.677,219.8857,220.0943,220.3029,220.5115,220.7202,220.9288,221.1374,221.346,221.5547,221.7633,222.1805,222.3892,222.5978,222.8064,223.015,223.2237,223.4323,223.6409,223.8495,224.0582,224.2668,224.4754,224.6841,224.8927,225.3099,225.5186,225.7272,225.9358,226.1444,226.3531,226.5617,226.7703,226.9789,227.1876,227.3962,227.6048,227.8137,228.231,228.4396,228.6482,228.8569,229.0655,229.2741,229.4827,229.6914,229.9,230.1086,230.3172,230.5259,230.7345,231.1517,231.3604,231.569,231.7776,231.9862,232.1949,232.4035,232.6121,232.8207,233.0294,233.238,233.4466,233.6552,233.8639,234.2811,234.4898,234.6984,234.907,235.1156,235.3243,235.5329,235.7415,235.9501,236.1588,236.3674,236.576,236.7846,237.2019,237.4105,237.6191,237.8278,238.0364,238.245,238.4536,238.6623,238.8709,239.0795,239.2881,239.4968,239.7054,240.1227,240.3313,240.5399,240.7485,240.9572,241.1658,241.3744,241.583,241.7917,242.0003,242.2089,242.4175,242.6262,242.8348,243.252,243.4607,243.6693,243.8779,244.0865,244.2952,244.5038,244.7124,244.9211,245.1297,245.3383,245.5469,245.7556,246.1728,246.3814,246.5901,246.7987,247.0073,247.2159,247.4246,247.6332,247.8418,248.0504,248.2591,248.4677,248.6763,248.8849,249.3022,249.5108,249.7195,249.9281,250.1367,250.3453,250.554,250.7626,250.9712,251.1798,251.3885,251.5971,251.8057,252.223,252.4316,252.6402,252.8488,253.0575,253.2661,253.4747,253.6833,253.892,254.1006,254.3092,254.5179,254.7265,255.1437,255.3524,255.561,255.7696,255.9782,256.1869,256.3955,256.6041,256.8127,257.0214,257.23,257.4386,257.6472,257.8559,258.2731,258.4818,258.6904,258.899,259.1076,259.3162,259.5249,259.7335,259.9421,260.1508,260.3594,260.568,260.7766,261.1939,261.4025,261.6111,261.8198,262.0284,262.237,262.4456,262.6543,262.8629,263.0715,263.2802,263.4888,263.6974,264.1146,264.3233,264.5319,264.7405,264.9492,265.1578,265.3664,265.575,265.7836,265.9923,266.2009,266.4095,266.6182,266.8268,267.244,267.4526,267.6613,267.8699,268.0786,268.2872,268.4958,268.7044,268.913,269.1217,269.3303,269.5389,269.7476,270.1648,270.3734,270.582,270.7907,270.9993,271.2079,271.4166,271.6252,271.8338,272.0424,272.251,272.4597,272.6683])
Q_y = np.array([351.6133,351.6133,351.6133,351.6133,351.6133,352.0306,352.4478,353.0737,353.6996,354.3255,354.5341,354.5341,354.1169,353.2823,352.0306,350.3616,348.4837,346.606,344.937,343.4767,342.4335,342.0163,342.2249,343.268,344.937,347.0233,349.7354,352.4478,355.5772,358.2894,360.7929,362.8792,364.3395,365.3827,365.5913,365.174,364.1309,362.6705,360.7929,358.498,356.2031,353.6996,351.1961,348.9009,346.8147,345.1457,343.8939,342.8508,342.2249,341.8076,341.8076,342.0163,342.4335,343.0594,343.8939,344.7284,345.5629,346.8147,347.8578,349.3182,350.7788,352.4478,354.1169,355.9945,357.8721,359.7498,361.2101,362.6705,363.7137,364.3395,364.5482,364.5482,364.1309,363.505,362.6705,361.6274,361.0015,360.3756,359.7498,359.5411,359.5411,359.5411,359.5411,359.5411,359.1239,358.2894,357.0376,355.3686,353.2823,350.7788,348.2751,345.7715,343.4767,341.8076,340.7645,340.5559,341.3904,343.0594,345.3543,348.4837,352.0306,355.5772,359.1239,362.0446,364.5482,366.4258,367.2603,367.2603,366.4258,364.7568,362.4619,359.3325,355.9945,352.4478,348.6923,344.937,341.599,338.6783,336.3834,334.7144,334.0885,334.0885,335.3402,337.4265,340.3473,343.8939,347.8578,351.822,355.7859,358.9153,361.4188,362.8792,363.2964,362.6705,361.0015,358.498,355.3686,352.0306,348.9009,346.1888,344.3112,343.268,343.6853,345.1457,347.6492,350.9875,354.7427,358.7066,362.4619,365.3827,367.6776,368.9293,369.1379,368.3034,366.6344,364.5482,361.836,359.1239,356.829,354.7427,353.2823,352.6565,352.6565,353.491,354.9514,357.0376,359.3325,361.836,364.3395,366.4258,367.8862,368.7207,368.7207,367.6776,366.0085,363.2964,360.167,356.6204,352.8651,349.3182,345.7715,342.8508,340.3473,338.6783,337.8438,337.8438,338.6783,340.1386,342.0163,344.5198,347.2319,349.9441,352.4478,354.7427,356.6204,357.8721,358.498,358.498,358.0807,357.0376,355.5772,353.6996,352.0306,350.3616,348.6923,347.6492,346.8147,346.3974,346.606,347.0233,348.0664,349.1096,350.3616,351.822,353.0737,353.9082,354.7427,354.9514,354.9514,354.3255,353.491,352.2392,350.7788,349.1096,347.4406,345.9802,344.7284,343.6853,343.268,343.0594,343.4767,344.1025,345.1457,346.3974,347.6492,348.9009,350.1527,351.1961,352.0306,352.6565,352.6565,352.4478,352.0306,351.4047,350.5702,349.5268,348.6923,347.8578,347.0233,346.606,346.1888,346.1888,346.606,347.2319,347.8578,348.9009,350.1527,351.1961,352.4478,353.491,354.3255,354.7427,354.9514,354.7427,354.3255,353.2823,352.2392,350.7788,349.3182,347.8578,346.3974,345.1457,344.3112,343.6853,343.6853,344.1025,344.937,346.3974,348.0664,350.1527,352.2392,354.3255,355.9945,357.4549,358.498,358.9153,358.7066,357.8721,356.4117,354.5341,352.4478,350.1527,347.8578,345.7715,344.1025,343.0594,342.6422,342.8508,343.8939,345.7715,348.0664,350.7788,353.491,356.4117,358.9153,361.0015,362.4619,363.0878,363.0878,362.0446,360.3756,357.8721,354.9514,351.6133,348.2751,344.937,342.0163,339.7214,338.0524,337.2179,337.4265,338.4696,340.3473,343.0594,345.9802,349.1096,352.4478,355.3686,357.8721,359.5411,360.7929,361.2101,360.7929,359.9584,358.498,356.829,355.16,353.491,351.822,350.7788,349.7354,349.3182,349.1096,349.1096,349.3182,349.7354,350.1527,350.5702,350.7788,351.1961,351.4047,351.6133,351.822,352.0306,352.2392,352.4478,352.6565,352.8651,353.0737,353.2823,353.2823,353.0737,352.8651,352.4478,352.0306,351.6133,350.9875,350.5702,350.1527,349.9441,349.7354,349.7354,349.9441,350.3616,350.5702,350.9875,351.1961,351.1961,351.1961,350.7788,349.9441,348.9009,347.6492,345.9802,344.5198,343.268,342.2249,341.8076,342.0163,342.6422,343.6853,345.1457,346.606,348.0664,349.3182,349.7354,349.7354,348.9009,347.4406,345.3543,343.268,341.1818,339.5128,338.4696,338.0524,338.0524,338.4696,338.4696,338.261,337.6351,336.592,335.5489,334.7144,334.2971,334.0885,334.5057,335.3402,336.3834,337.8438,339.5128,341.1818,342.6422,343.8939,344.3112,344.5198,344.1025,343.4767,342.6422,342.0163,341.599,341.3904,341.3904,341.8076,342.2249,343.0594,344.3112,345.7715,347.4406,349.3182,351.4047,353.6996,355.7859,357.8721,359.7498,361.2101,362.0446,362.2533,361.6274,360.167,357.8721,355.16,352.2392,349.3182,346.606,344.3112,342.4335,341.1818,340.5559,340.7645,341.599,343.268,345.3543,348.0664,350.9875,353.9082,356.829,359.7498,362.4619,364.7568,366.843,368.5121,369.5552,370.1811,370.3897,369.9724,369.3466,368.3034,367.2603,366.0085,364.7568,363.505,362.0446,360.7929,359.3325,357.6635,355.7859,353.9082,351.822,349.5268,347.4406,345.3543,343.4767,341.8076,340.5559,339.93,339.7214,340.1386,341.3904,343.0594,345.1457,347.2319,349.5268,350.9875,351.6133,351.6133,351.6133,351.6133])
I_x = np.array([159.3841,159.5927,159.8014,160.01,160.2186,160.4272,160.6359,160.8445,161.0531,161.2617,161.4704,161.679,161.8876,162.3049,162.5135,162.7221,162.9308,163.1394,163.348,163.5566,163.7653,163.9739,164.1825,164.3911,164.5998,164.8084,165.2256,165.4343,165.6429,165.8515,166.0602,166.2688,166.4774,166.686,166.8947,167.1033,167.3119,167.5205,167.7292,167.9378,168.355,168.5637,168.7723,168.9809,169.1895,169.3982,169.6068,169.8154,170.024,170.2327,170.4413,170.6499,170.8586,171.2758,171.4844,171.6931,171.9017,172.1103,172.3189,172.5276,172.7362,172.9448,173.1534,173.3621,173.5707,173.7793,174.1966,174.4052,174.6138,174.8224,175.0311,175.2397,175.4483,175.657,175.8656,176.0742,176.2828,176.4915,176.7001,176.9087,177.326,177.5346,177.7432,177.9518,178.1605,178.3691,178.5777,178.7863,178.995,179.2036,179.4122,179.6208,179.8295,180.2467,180.4554,180.664,180.8726,181.0812,181.2899,181.4985,181.7071,181.9157,182.1244,182.333,182.5416,182.7502,183.1675,183.3761,183.5847,183.7934,184.002,184.2106,184.4192,184.6279,184.8365,185.0451,185.2537,185.4624,185.671,185.8796,186.2969,186.5055,186.7141,186.9228,187.1314,187.34,187.5486,187.7573,187.9659,188.1745,188.3831,188.5918,188.8004,189.2176,189.4263,189.6349,189.8435,190.0521,190.2608,190.4694,190.678,190.8866,191.0953,191.3039,191.5125,191.7211,191.9298,192.347,192.5557,192.7643,192.9729,193.1815,193.3902,193.5988,193.8074,194.016,194.2247,194.4333,194.6419,194.8505,195.2678,195.4764,195.685,195.8937,196.1023,196.3109,196.5195,196.7282,196.9368,197.1454,197.354,197.5627,197.7713,198.1886,198.3972,198.6058,198.8144,199.0231,199.2317,199.4403,199.6489,199.8576,200.0662,200.2748,200.4834,200.6921,200.9007,201.3179,201.5266,201.7352,201.9438,202.1525,202.3611,202.5697,202.7783,202.987,203.1956,203.4042,203.6128,203.8215,204.2387,204.4473,204.656,204.8646,205.0732,205.2818,205.4905,205.6991,205.9077,206.1163,206.325,206.5336,206.7422,207.1595,207.3681,207.5767,207.7854,207.994,208.2026,208.4112,208.6199,208.8285,209.0371,209.2457,209.4544,209.663,209.8716,210.2889,210.4975,210.7061,210.9147,211.1234,211.332,211.5406,211.7492,211.9579,212.1665,212.3751,212.5837,212.7924,213.2096,213.4182,213.6269,213.8355,214.0441,214.2527,214.4614,214.67,214.8786,215.0872,215.2959,215.5045,215.7131,216.1304,216.339,216.5476,216.7563,216.9649,217.1735,217.3821,217.5908,217.7994,218.008,218.2166,218.4253,218.6339,218.8425,219.2598,219.4684,219.677,219.8857,220.0943,220.3029,220.5115,220.7202,220.9288,221.1374,221.346,221.5547,221.7633,222.1805,222.3892,222.5978,222.8064,223.015,223.2237,223.4323,223.6409,223.8495,224.0582,224.2668,224.4754,224.6841,224.8927,225.3099,225.5186,225.7272,225.9358,226.1444,226.3531,226.5617,226.7703,226.9789,227.1876,227.3962,227.6048,227.8137,228.231,228.4396,228.6482,228.8569,229.0655,229.2741,229.4827,229.6914,229.9,230.1086,230.3172,230.5259,230.7345,231.1517,231.3604,231.569,231.7776,231.9862,232.1949,232.4035,232.6121,232.8207,233.0294,233.238,233.4466,233.6552,233.8639,234.2811,234.4898,234.6984,234.907,235.1156,235.3243,235.5329,235.7415,235.9501,236.1588,236.3674,236.576,236.7846,237.2019,237.4105,237.6191,237.8278,238.0364,238.245,238.4536,238.6623,238.8709,239.0795,239.2881,239.4968,239.7054,240.1227,240.3313,240.5399,240.7485,240.9572,241.1658,241.3744,241.583,241.7917,242.0003,242.2089,242.4175,242.6262,242.8348,243.252,243.4607,243.6693,243.8779,244.0865,244.2952,244.5038,244.7124,244.9211,245.1297,245.3383,245.5469,245.7556,246.1728,246.3814,246.5901,246.7987,247.0073,247.2159,247.4246,247.6332,247.8418,248.0504,248.2591,248.4677,248.6763,248.8849,249.3022,249.5108,249.7195,249.9281,250.1367,250.3453,250.554,250.7626,250.9712,251.1798,251.3885,251.5971,251.8057,252.223,252.4316,252.6402,252.8488,253.0575,253.2661,253.4747,253.6833,253.892,254.1006,254.3092,254.5179,254.7265,255.1437,255.3524,255.561,255.7696,255.9782,256.1869,256.3955,256.6041,256.8127,257.0214,257.23,257.4386,257.6472,257.8559,258.2731,258.4818,258.6904,258.899,259.1076,259.3162,259.5249,259.7335,259.9421,260.1508,260.3594,260.568,260.7766,261.1939,261.4025,261.6111,261.8198,262.0284,262.237,262.4456,262.6543,262.8629,263.0715,263.2802,263.4888,263.6974,264.1146,264.3233,264.5319,264.7405,264.9492,265.1578,265.3664,265.575,265.7836,265.9923,266.2009,266.4095,266.6182,266.8268,267.244,267.4526,267.6613,267.8699,268.0786,268.2872,268.4958,268.7044,268.913,269.1217,269.3303,269.5389,269.7476,270.1648,270.3734,270.582,270.7907,270.9993,271.2079,271.4166,271.6252,271.8338,272.0424,272.251,272.4597,272.6683])
I_y = np.array([351.6133,351.6133,351.6133,351.6133,351.6133,352.0306,352.6565,353.491,354.5341,355.7859,357.0376,358.0807,359.1239,359.9584,360.3756,360.167,359.5411,358.2894,356.4117,353.9082,351.1961,348.0664,345.1457,342.2249,339.7214,337.8438,336.3834,335.9661,336.1747,337.2179,339.0955,341.1818,343.8939,346.8147,349.9441,352.8651,355.5772,358.0807,359.9584,361.6274,362.4619,362.8792,362.8792,362.4619,361.6274,360.3756,359.1239,357.6635,356.2031,354.7427,353.2823,352.0306,350.9875,349.9441,349.1096,348.2751,347.6492,347.2319,346.8147,346.3974,346.1888,346.1888,346.3974,346.8147,347.4406,348.2751,349.5268,350.7788,352.2392,353.9082,355.16,356.4117,357.4549,358.0807,358.498,358.2894,358.0807,357.4549,357.0376,356.4117,355.9945,355.7859,355.9945,356.4117,356.829,357.6635,358.2894,358.498,358.498,357.8721,356.6204,354.5341,351.822,348.2751,344.5198,340.5559,336.8006,333.254,330.3332,328.2469,327.4124,327.4124,328.6642,330.7505,333.6712,337.2179,340.9731,344.937,348.9009,352.4478,355.5772,358.0807,359.9584,361.0015,361.2101,360.5843,359.3325,357.2462,354.7427,351.6133,348.2751,344.7284,341.599,338.6783,336.592,335.1316,334.923,335.5489,337.2179,339.7214,343.0594,346.606,350.5702,354.1169,357.0376,359.3325,360.3756,360.5843,359.3325,357.4549,354.5341,351.1961,347.6492,344.3112,341.599,339.93,339.3041,339.7214,341.3904,343.8939,347.0233,350.3616,353.9082,357.0376,359.5411,361.2101,362.0446,361.836,361.0015,359.3325,357.2462,354.7427,352.2392,349.9441,348.0664,346.8147,346.1888,346.1888,347.2319,348.9009,350.9875,353.6996,356.6204,359.3325,361.836,363.9223,365.3827,366.0085,365.7999,364.7568,362.8792,360.3756,357.4549,353.9082,350.5702,347.0233,343.8939,341.1818,339.0955,337.4265,336.8006,336.8006,337.4265,338.8869,340.5559,342.6422,344.937,347.2319,349.3182,350.9875,352.2392,353.0737,353.0737,352.8651,352.0306,350.9875,349.7354,348.4837,347.2319,345.9802,345.1457,344.7284,344.7284,345.1457,345.9802,347.2319,348.4837,350.1527,351.822,353.2823,354.7427,355.5772,356.2031,356.4117,356.2031,355.5772,354.5341,353.2823,351.822,350.3616,349.1096,347.8578,347.0233,346.3974,346.3974,346.606,347.0233,347.8578,348.9009,350.1527,351.1961,352.4478,353.2823,354.1169,354.5341,354.7427,354.7427,354.3255,353.6996,353.0737,352.2392,351.4047,350.3616,349.7354,349.1096,348.6923,348.6923,348.9009,349.3182,350.1527,351.1961,352.4478,353.6996,354.9514,356.2031,357.2462,357.8721,358.2894,358.2894,357.8721,357.0376,355.7859,354.3255,352.6565,350.7788,349.1096,347.4406,346.1888,345.3543,344.937,345.1457,345.9802,347.2319,348.9009,350.7788,353.0737,355.16,357.0376,358.7066,359.9584,360.3756,360.167,359.3325,357.8721,355.9945,353.491,350.9875,348.4837,345.9802,344.1025,342.6422,342.0163,342.0163,343.0594,344.5198,346.8147,349.5268,352.4478,355.5772,358.498,361.0015,363.0878,364.3395,364.9654,364.5482,363.505,361.4188,358.9153,355.7859,352.4478,349.3182,346.1888,343.6853,341.8076,340.5559,340.3473,340.9731,342.2249,344.3112,346.606,349.3182,352.0306,354.3255,356.4117,358.0807,359.1239,359.5411,359.5411,358.9153,358.0807,357.0376,355.9945,354.9514,353.9082,353.0737,352.2392,351.6133,351.1961,350.7788,350.5702,350.1527,349.7354,349.3182,349.1096,348.6923,348.4837,348.2751,348.0664,348.0664,348.0664,348.2751,348.2751,348.2751,348.2751,348.2751,348.0664,347.8578,347.6492,347.2319,346.8147,346.606,346.3974,346.3974,346.606,347.0233,347.8578,348.9009,350.3616,351.822,353.491,354.9514,356.2031,357.2462,357.6635,357.6635,357.0376,355.7859,354.1169,352.2392,350.5702,349.1096,348.2751,347.8578,347.8578,348.2751,348.9009,349.7354,350.3616,350.7788,350.7788,350.1527,349.1096,347.6492,345.9802,344.5198,343.4767,343.0594,343.0594,343.4767,343.6853,343.8939,343.6853,343.0594,342.2249,341.1818,340.1386,339.3041,338.6783,338.6783,338.8869,339.7214,340.9731,342.6422,344.3112,346.1888,347.8578,349.1096,349.9441,350.3616,350.5702,350.3616,349.9441,349.3182,348.6923,348.0664,347.2319,346.606,346.1888,345.9802,345.9802,346.606,347.6492,349.1096,351.1961,353.6996,356.4117,359.1239,361.6274,363.7137,365.174,365.7999,365.7999,364.9654,363.2964,361.2101,358.7066,355.7859,352.8651,349.9441,347.4406,345.3543,343.6853,342.6422,342.2249,342.2249,343.0594,344.1025,345.9802,348.0664,350.5702,353.491,356.6204,359.5411,362.6705,365.3827,367.8862,369.7638,371.0156,371.4328,371.2242,370.3897,368.9293,366.843,364.5482,361.6274,358.7066,355.16,351.6133,347.8578,343.8939,340.1386,336.3834,333.0453,330.5418,328.6642,328.0383,328.6642,330.3332,333.4626,337.4265,342.0163,346.606,350.1527,351.6133,351.6133,351.6133,351.6133])
(I_x, I_y) = normalisePoints(I_x,I_y,len(I_x))
(Q_x, Q_y) = normalisePoints(Q_x,Q_y,len(I_x))
qubit_pulses = (I_x, I_y, Q_x, Q_y)

# Plot
plotPulsesTimeDomain(resonator_pulses, 'Resonator pulses');
plotPulsesTimeDomain(qubit_pulses, 'Qubit pulses');
plotPulsesPhaseSpace(resonator_pulses, 'Resonator pulse');
plotPulsesPhaseSpace(qubit_pulses, 'Qubit pulse');


# In[ ]:


samples = len(qubit_pulses[1])
power_two = 2**30
signal_resonator = resonator_pulses[1] + 1j*resonator_pulses[3]
signal_resonator = np.pad(signal_resonator, (0, power_two-samples), mode='constant')
samples = power_two

time = np.linspace(0, samples*sample_interval, samples)

sample_interval = 1e-9 # 1 ns
sample_frequency = 1e9 # 1 GHz

time = np.linspace(0, samples*sample_interval, samples)


signal_spectrum = np.fft.fftshift(np.fft.fft(signal_resonator))
freqs = np.fft.fftshift(np.fft.fftfreq(samples, d=sample_interval))

plt.figure(figsize=(10,5))
plt.plot(freqs / 1e6, np.abs(signal_spectrum))  # in MHz
plt.xlim(0, 125)
plt.title('Resonator pulse spectrum')
plt.xlabel('f (MHz)');

signal_qubit = qubit_pulses[1] + 1j*qubit_pulses[3]
signal_spectrum = np.fft.fftshift(np.fft.fft(signal_qubit))
freqs = np.fft.fftshift(np.fft.fftfreq(samples, d=sample_interval))

plt.figure(figsize=(10,5))
plt.plot(freqs / 1e6, np.abs(signal_spectrum))  # in MHz
plt.xlim(0, 125)
plt.title('Qubit pulse spectrum')
plt.xlabel('f (MHz)');


# Conclusion: the frequency spectrum does not provide any explanation of the pulse shapes (for me at least)
